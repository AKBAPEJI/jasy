<html>
  <head>
    <title>Jasy Test Suite</title>
    
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <link rel="stylesheet" href="qunit.css" type="text/css" media="screen" title="no title" charset="utf-8">
    <script src="qunit.js" type="text/javascript" charset="utf-8"></script>
    
    <script src="../jscore/src/ext/Array.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/ext/Function.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/ext/String.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/ext/Object.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/ext/RegExp.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/ext/Date.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/ext/Number.js" type="text/javascript" charset="utf-8"></script>

    <script src="../jscore/src/ext/console.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/ext/document.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/ext/setTimeout.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/ext/setImmediate.js" type="text/javascript" charset="utf-8"></script>

    <script src="../jscore/src/Core.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/Permutation.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/Assert.js" type="text/javascript" charset="utf-8"></script>

    <script src="../jscore/src/Module.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/Class.js" type="text/javascript" charset="utf-8"></script>
    <script src="../jscore/src/Interface.js" type="text/javascript" charset="utf-8"></script>
    
  </head>
  <body>
    <h1 id="qunit-header">Jasy Test Suite</h1>
    <h2 id="qunit-banner"></h2>
    <div id="qunit-testrunner-toolbar"></div>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
    
    <script type="text/javascript">
    var global = this;
    $(function() {
      
      module("setTimeout");
      
      asyncTest("Using arguments", 1, function() {
        setTimeout(function(arg) {
          equals(arg, "hello");
          start();
        }, 10, "hello");
      });



      module("setImmediate");
      
      asyncTest("Set and Fire", 1, function() {
        setImmediate(function() {
          ok(true, "always fine");
          start();
        });
      });


      
      module("Namespace", {
        teardown : function() {
          delete global.foo;
          delete global.abc;
        }
      });
      
      test("Creating global", function() {
        Core.declare('foo', 3);
        equals(global.foo, 3);
      });

      test("Creating namespace", function() {
        Core.declare('abc.def', 5);
        equals(global.abc.def, 5);
      });
      
      
      
      
      module("Modules", {
        teardown : function() {
          delete global.abc;
        }
      });
      
      test("Creating empty module", function() {
        Module("abc.Module1", {});
        equals(Module.isModule(abc.Module1), true);
        equals(abc.Module1.moduleName, "abc.Module1");
        equals(abc.Module1.toString(), "[Module abc.Module1]");
      });

      test("Module validation", function() {
        equals(Module.isModule({}), false);
        equals(Module.isModule(3), false);
        equals(Module.isModule(null), false);
        equals(Module.isModule({__isModule:true}), false);
      });
      
      test("Creating method module", function() {
        Module("abc.Module2", {
          method1 : function() {},
          method2 : function() {},
          method3 : function() {}
        });
        equals(Module.isModule(abc.Module2), true);
        ok(abc.Module2.method1 instanceof Function);
        ok(abc.Module2.method2 instanceof Function);
        ok(abc.Module2.method3 instanceof Function);
        equals(abc.Module2.method1.displayName, "abc.Module2.method1");
        equals(abc.Module2.method2.displayName, "abc.Module2.method2");
        equals(abc.Module2.method3.displayName, "abc.Module2.method3");
      });
      
      test("Checking module name", function() {
        raises(function() {
          Module("", {});
        });
        raises(function() {
          Module(true, {});
        });
        raises(function() {
          Module(" SpaceVoodoo ", {});
        });
        raises(function() {
          Module("has space", {});
        });
        raises(function() {
          Module("firstLow", {});
        });
        raises(function() {
          Module("two..Dots", {});
        });
      });
      
      
      
      
      module("Classes", {
        teardown : function() {
          delete global.abc;
          delete global.conflict;
        }
      });
      
      test("Creating empty class", function() {
        Class("abc.Class1", {});
        equals(Class.isClass(abc.Class1), true);
        equals(abc.Class1.className, "abc.Class1");
        equals(abc.Class1.toString(), "[Class abc.Class1]");
      });
      
      test("Conflicting members", function() {
        Class("conflict.Include1", {
          members : {
            foo : function() {}
          }
        });
        Class("conflict.Include2", {
          members : {
            foo : function() {}
          }
        });

        raises(function() {
          Class("conflict.Join", {
            include : [conflict.Include1, conflict.Include2]
          });
        });
      });
      
      
      test("Conflicting members with merge", function() {
        Class("conflict.Include1", {
          members : {
            foo : function() {}
          }
        });
        Class("conflict.Include2", {
          members : {
            foo : function() {}
          }
        });

        Class("conflict.Join", {
          include : [conflict.Include1, conflict.Include2],
          
          members : {
            // Merge conflict manually
            foo : function() {
              conflict.Include1.prototype.foo.call(this);
              conflict.Include2.prototype.foo.call(this);
            }
          }
        });
      });
      
      
      
      
      
      
    })
    </script>
  </body>
</html>
