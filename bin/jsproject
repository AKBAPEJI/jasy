#!/usr/bin/env python3

import sys, os

# Extend PYTHONPATH with 'lib'
sys.path.insert(0, os.path.normpath(os.path.join(os.path.dirname(os.path.abspath(sys.argv[0])), os.pardir, "lib")))

from js import *

projects = [
  "/Users/Sebastian/Repositories/qooxdoo.unify/qooxdoo/framework",
  "/Users/Sebastian/Repositories/qooxdoo.unify/qooxdoo/component/apiviewer"
]

deps = [ "qx.core.Object" ]

knownClasses, knownResources, knownTranslations = getProjectFiles(projects)

print() 
print("Resolving dependencies...")
requiredClasses = set()
for className in deps:
    resolveDependencies(className, knownClasses, requiredClasses)
    

print() 
print("Sorting classes...")
sortedClasses = sortClasses(requiredClasses, knownClasses)
print(sortedClasses)



    
print("Compiling %s classes..." % len(requiredClasses))
    
compressed = []
for className in requiredClasses:
    classPath = knownClasses[className]
    classContent = open(classPath).read()
    
    #compressed.append(jscompress(jsparse(classContent, classPath)))
    
print(compressed)